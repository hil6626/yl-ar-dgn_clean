{
  "name": "L4 决策层",
  "description": "基于部署成熟度与任务上下文选择策略（先保证可运行，再逐步提升可重复/可观测/可回滚）",
  "version": "1.2.0",
  "lastUpdated": "2026-02-16",
  "deploymentStatus": {
    "currentMaturityLevel": 3,
    "targetMaturityLevel": 5,
    "phase1": {
      "name": "监控整合",
      "status": "completed",
      "completedDate": "2026-02-16",
      "decisionsApplied": [
        "maturity-1-strategy",
        "maturity-2-strategy"
      ]
    },
    "phase2": {
      "name": "User GUI优化",
      "status": "completed",
      "completedDate": "2026-02-16",
      "decisionsApplied": [
        "maturity-2-strategy"
      ]
    },
    "phase3": {
      "name": "规则架构部署",
      "status": "in_progress",
      "progress": "80%",
      "decisionsApplied": [
        "maturity-3-strategy"
      ],
      "decisionsPending": [
        "maturity-4-strategy",
        "maturity-5-strategy"
      ]
    }
  },
  "decisionMatrix": {
    "priorityLevels": ["critical", "high", "medium", "low"],
    "factors": ["impact", "urgency", "complexity", "resources", "deployment_maturity_level"]
  },
  "deploymentProfiles": [
    {
      "id": "local-manual",
      "maturityLevel": 1,
      "description": "手工运行：GUI + 静态监控页 + 手动脚本执行",
      "status": "completed",
      "completedDate": "2026-02-16"
    },
    {
      "id": "local-automated",
      "maturityLevel": 2,
      "description": "脚本化校验与执行：脚本映射/日志结构/健康检查可重复",
      "status": "completed",
      "completedDate": "2026-02-16"
    },
    {
      "id": "singlehost-managed",
      "maturityLevel": 3,
      "description": "单机受控：进程守护 + 配置基线 + 回滚方案",
      "status": "in_progress",
      "progress": "60%"
    },
    {
      "id": "containerized",
      "maturityLevel": 4,
      "description": "容器化：可重复构建与部署",
      "status": "pending"
    },
    {
      "id": "production-ready",
      "maturityLevel": 5,
      "description": "生产级：可观测/可追踪/可审计/可降级",
      "status": "pending"
    }
  ],
  "strategies": [
    {
      "id": "maturity-1-strategy",
      "name": "Level 1 - 最小闭环",
      "conditions": ["deployment_maturity_level == 1"],
      "actions": ["document_entrypoints", "ensure_log_dirs", "basic_health_check"],
      "status": "completed",
      "completedDate": "2026-02-16",
      "notes": "阶段1完成：所有组件入口已文档化，健康检查已配置"
    },
    {
      "id": "maturity-2-strategy",
      "name": "Level 2 - 自动化一致性",
      "conditions": ["deployment_maturity_level == 2"],
      "actions": ["align_script_contracts", "validate_api_map_routes", "repeatable_checks"],
      "status": "completed",
      "completedDate": "2026-02-16",
      "notes": "阶段2完成：脚本契约已对齐，API路由已验证，检查可重复执行"
    },
    {
      "id": "maturity-3-strategy",
      "name": "Level 3 - 受控部署",
      "conditions": ["deployment_maturity_level == 3"],
      "actions": ["process_supervision", "config_baseline", "rollback_plan", "service_health_endpoints"],
      "status": "in_progress",
      "progress": "60%",
      "notes": "阶段3进行中：进程守护待配置，配置基线已建立，健康端点已完成"
    },
    {
      "id": "maturity-4-strategy",
      "name": "Level 4 - 容器化",
      "conditions": ["deployment_maturity_level == 4"],
      "actions": ["container_build", "config_injection", "health_probes"],
      "status": "pending",
      "notes": "阶段4计划：Docker Compose配置已存在，需完善容器化策略"
    },
    {
      "id": "maturity-5-strategy",
      "name": "Level 5 - 生产级",
      "conditions": ["deployment_maturity_level == 5"],
      "actions": ["metrics_alerts", "audit_trail", "graceful_degradation"],
      "status": "pending",
      "notes": "阶段5计划：五层监控架构已设计，待实施完整可观测性方案"
    }
  ],
  "rules": [
    {
      "id": "select-profile-1",
      "condition": { "field": "deployment_maturity_level", "operator": "equals", "value": 1 },
      "action": { "target": "deployment_profile", "value": "local-manual" },
      "description": "成熟度 1 选择 local-manual",
      "status": "completed"
    },
    {
      "id": "select-profile-2",
      "condition": { "field": "deployment_maturity_level", "operator": "equals", "value": 2 },
      "action": { "target": "deployment_profile", "value": "local-automated" },
      "description": "成熟度 2 选择 local-automated",
      "status": "completed"
    },
    {
      "id": "select-profile-3plus",
      "condition": { "field": "deployment_maturity_level", "operator": "greater_or_equal", "value": 3 },
      "action": { "target": "process_supervision", "value": "required" },
      "description": "成熟度 >= 3 需要进程守护",
      "status": "in_progress"
    },
    {
      "id": "containerize-4plus",
      "condition": { "field": "deployment_maturity_level", "operator": "greater_or_equal", "value": 4 },
      "action": { "target": "containerization", "value": true },
      "description": "成熟度 >= 4 进入容器化轨道",
      "status": "pending"
    },
    {
      "id": "monitor-api-prefix",
      "condition": { "field": "context", "operator": "contains", "value": "monitor-frontend" },
      "action": { "target": "monitor_api_prefix", "value": "/monitor/api" },
      "description": "监控前端统一使用 /monitor/api 前缀（同源联调优先）",
      "status": "completed",
      "notes": "阶段1完成：YL-monitor使用/api/v1/monitor前缀"
    },
    {
      "id": "quick-ops-decision",
      "condition": { "field": "task_type", "operator": "equals", "value": "daily_ops" },
      "action": { "target": "use_quick_scripts", "value": true },
      "description": "日常运维任务优先使用快速运维脚本",
      "status": "completed",
      "notes": "优化建议实施：start-all.sh, stop-all.sh, check-status.sh已创建并验证"
    },
    {
      "id": "five-layer-monitoring-decision",
      "condition": { "field": "monitoring_requirement", "operator": "equals", "value": "comprehensive" },
      "action": { "target": "monitoring_architecture", "value": "five_layer" },
      "description": "全面监控需求采用五层监控架构（L1-L5）",
      "status": "in_progress",
      "notes": "阶段3进行中：五层监控端点已注册，监控器已创建，待完善告警规则"
    }
  ]
}
