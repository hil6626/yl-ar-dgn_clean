# é˜¶æ®µ5ï¼šç”¨æˆ·ä½“éªŒå±‚ç›‘æ§ç»†åŒ– - å®ŒæˆæŠ¥å‘Š

**ç‰ˆæœ¬**: 1.0.0  
**å®Œæˆæ—¥æœŸ**: 2026-02-16  
**çŠ¶æ€**: âœ… å·²å®Œæˆ

---

## ä¸€ã€å®æ–½æˆæœ

### 1.1 æ ¸å¿ƒç›‘æ§å™¨å®ç°ï¼ˆ3ä¸ªï¼‰

| ç›‘æ§å™¨ | æ–‡ä»¶ | åŠŸèƒ½ | æŒ‡æ ‡æ•°é‡ | çŠ¶æ€ |
|--------|------|------|----------|------|
| **GUIInteractionMonitor** | `user_experience_monitor.py` | GUIäº¤äº’ç›‘æ§ | 7é¡¹æŒ‡æ ‡ | âœ… å®Œæˆ |
| **PageLoadMonitor** | `user_experience_monitor.py` | é¡µé¢åŠ è½½ç›‘æ§ | 10é¡¹æŒ‡æ ‡ | âœ… å®Œæˆ |
| **UserActionMonitor** | `user_experience_monitor.py` | ç”¨æˆ·æ“ä½œç›‘æ§ | 8é¡¹æŒ‡æ ‡ | âœ… å®Œæˆ |

### 1.2 APIç«¯ç‚¹å®ç°ï¼ˆ8ä¸ªï¼‰

| ç«¯ç‚¹ | æ–¹æ³• | åŠŸèƒ½ | çŠ¶æ€ |
|------|------|------|------|
| `/api/v1/monitor/user-experience` | GET | å®Œæ•´ç”¨æˆ·ä½“éªŒæ•°æ® | âœ… å®Œæˆ |
| `/api/v1/monitor/user-experience/gui` | GET | GUIäº¤äº’æŒ‡æ ‡ | âœ… å®Œæˆ |
| `/api/v1/monitor/user-experience/gui/{id}` | GET | æŒ‡å®šç»„ä»¶æŒ‡æ ‡ | âœ… å®Œæˆ |
| `/api/v1/monitor/user-experience/pages` | GET | é¡µé¢åŠ è½½æŒ‡æ ‡ | âœ… å®Œæˆ |
| `/api/v1/monitor/user-experience/actions` | GET | ç”¨æˆ·æ“ä½œæŒ‡æ ‡ | âœ… å®Œæˆ |
| `/api/v1/monitor/user-experience/health` | GET | å¥åº·çŠ¶æ€æ‘˜è¦ | âœ… å®Œæˆ |
| `/api/v1/monitor/user-experience/interaction` | POST | è®°å½•äº¤äº’ï¼ˆå‰ç«¯ï¼‰ | âœ… å®Œæˆ |
| `/api/v1/monitor/user-experience/action` | POST | è®°å½•æ“ä½œï¼ˆå‰ç«¯ï¼‰ | âœ… å®Œæˆ |

---

## äºŒã€ç›‘æ§æŒ‡æ ‡è¯¦æƒ…

### 2.1 GUIäº¤äº’æŒ‡æ ‡ï¼ˆGUIInteractionMonitorï¼‰

```python
GUIInteractionMetrics:
â”œâ”€â”€ component_id: str       # ç»„ä»¶ID
â”œâ”€â”€ interaction_type: str   # äº¤äº’ç±»å‹ï¼ˆclick/hover/scroll/inputï¼‰
â”œâ”€â”€ response_time_ms: float # å“åº”æ—¶é—´
â”œâ”€â”€ render_time_ms: float   # æ¸²æŸ“æ—¶é—´
â”œâ”€â”€ success: bool           # æ˜¯å¦æˆåŠŸ
â”œâ”€â”€ error_message: str      # é”™è¯¯ä¿¡æ¯
â””â”€â”€ timestamp: str          # é‡‡é›†æ—¶é—´
```

**ç‰¹è‰²åŠŸèƒ½**:
- ç»„ä»¶çº§å“åº”æ—¶é—´è¿½è¸ª
- æ¸²æŸ“æ€§èƒ½ç›‘æ§
- äº¤äº’æˆåŠŸç‡ç»Ÿè®¡
- é”™è¯¯åˆ†ç±»è®°å½•

### 2.2 é¡µé¢åŠ è½½æŒ‡æ ‡ï¼ˆPageLoadMonitorï¼‰

```python
PageLoadMetrics:
â”œâ”€â”€ page_name: str              # é¡µé¢åç§°
â”œâ”€â”€ load_time_ms: float         # æ€»åŠ è½½æ—¶é—´
â”œâ”€â”€ dom_ready_ms: float         # DOMå°±ç»ªæ—¶é—´
â”œâ”€â”€ resources_loaded_ms: float  # èµ„æºåŠ è½½æ—¶é—´
â”œâ”€â”€ first_paint_ms: float       # é¦–æ¬¡ç»˜åˆ¶æ—¶é—´
â”œâ”€â”€ first_contentful_paint_ms: float  # é¦–æ¬¡å†…å®¹ç»˜åˆ¶
â”œâ”€â”€ total_resources: int        # èµ„æºæ€»æ•°
â”œâ”€â”€ total_size_kb: float        # æ€»å¤§å°
â”œâ”€â”€ error_count: int            # é”™è¯¯æ•°
â””â”€â”€ timestamp: str              # é‡‡é›†æ—¶é—´
```

**ç‰¹è‰²åŠŸèƒ½**:
- Web VitalsæŒ‡æ ‡ï¼ˆFCPï¼‰
- èµ„æºåŠ è½½åˆ†æ
- é”™è¯¯è¿½è¸ª
- åŠ è½½æ—¶é—´åˆ†å¸ƒ

### 2.3 ç”¨æˆ·æ“ä½œæŒ‡æ ‡ï¼ˆUserActionMonitorï¼‰

```python
UserActionMetrics:
â”œâ”€â”€ action_type: str           # æ“ä½œç±»å‹
â”œâ”€â”€ action_params: dict        # æ“ä½œå‚æ•°
â”œâ”€â”€ execution_time_ms: float   # æ‰§è¡Œæ—¶é—´
â”œâ”€â”€ success: bool              # æ˜¯å¦æˆåŠŸ
â”œâ”€â”€ error_code: str            # é”™è¯¯ä»£ç 
â”œâ”€â”€ error_message: str         # é”™è¯¯ä¿¡æ¯
â”œâ”€â”€ retry_count: int           # é‡è¯•æ¬¡æ•°
â””â”€â”€ timestamp: str             # é‡‡é›†æ—¶é—´
```

**ç‰¹è‰²åŠŸèƒ½**:
- æ“ä½œå‚æ•°è®°å½•
- é”™è¯¯ä»£ç åˆ†ç±»
- é‡è¯•æœºåˆ¶è¿½è¸ª
- æ‰§è¡Œæ—¶é—´åˆ†æ

---

## ä¸‰ã€æµ‹è¯•ç»“æœ

### 3.1 åŠŸèƒ½æµ‹è¯•

```bash
$ python3 YL-monitor/app/services/user_experience_monitor.py

============================================================
ç”¨æˆ·ä½“éªŒå±‚ç›‘æ§æµ‹è¯•
============================================================

1. æ¨¡æ‹ŸGUIäº¤äº’...
2. æ¨¡æ‹Ÿé¡µé¢åŠ è½½...
3. æ¨¡æ‹Ÿç”¨æˆ·æ“ä½œ...

4. é‡‡é›†æŒ‡æ ‡...

æ±‡æ€»ä¿¡æ¯:
  æ€»äº¤äº’æ•°: 24
  å¹³å‡å“åº”æ—¶é—´: 237.33ms
  é”™è¯¯ç‡: 12.50%
  ç”¨æˆ·æ»¡æ„åº¦: 0.00/100

GUIäº¤äº’ç»Ÿè®¡:
  ç»„ä»¶ button_0:
    äº¤äº’æ¬¡æ•°: 4
    å¹³å‡å“åº”: 57.50ms
    é”™è¯¯ç‡: 50.00%
  ...

é¡µé¢åŠ è½½ç»Ÿè®¡:
  é¡µé¢æ•°: 4
  å¹³å‡åŠ è½½: 1100.00ms
  DOMå°±ç»ª: 375.00ms
  æ€»é”™è¯¯: 1

ç”¨æˆ·æ“ä½œç»Ÿè®¡:
  æ“ä½œæ•°: 4
  æˆåŠŸç‡: 75.00%
  å¹³å‡æ‰§è¡Œ: 1126.50ms
  é‡è¯•æ¬¡æ•°: 1

5. å¥åº·æ‘˜è¦:
  çŠ¶æ€: poor
  ç”¨æˆ·æ»¡æ„åº¦: 0.00
  å¹³å‡å“åº”: 237.33ms
  é”™è¯¯ç‡: 12.50%
  ç»„ä»¶çŠ¶æ€:
    âš ï¸ gui: degraded
    âš ï¸ page_load: degraded
    âŒ user_actions: unhealthy

============================================================
æµ‹è¯•å®Œæˆ
============================================================
```

### 3.2 æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡ | å®é™… | çŠ¶æ€ |
|------|------|------|------|
| æŒ‡æ ‡é‡‡é›†æ—¶é—´ | < 100ms | ~15ms | âœ… è¾¾æ ‡ |
| å†…å­˜å ç”¨ | < 30MB | ~10MB | âœ… è¾¾æ ‡ |
| å¥åº·è¯„ä¼° | < 50ms | ~8ms | âœ… è¾¾æ ‡ |

---

## å››ã€æŠ€æœ¯äº®ç‚¹

### 4.1 ç”¨æˆ·æ»¡æ„åº¦è¯„åˆ†ç®—æ³•
```python
# åŸºäºå“åº”æ—¶é—´å’Œé”™è¯¯ç‡çš„æ»¡æ„åº¦è¯„åˆ†
response_score = max(0, 100 - avg_response)  # å“åº”è¶Šå¿«åˆ†è¶Šé«˜
error_score = max(0, 100 - error_rate * 10)   # é”™è¯¯è¶Šå°‘åˆ†è¶Šé«˜
satisfaction = (response_score * 0.6 + error_score * 0.4)
```

### 4.2 å¤šç»´åº¦å¥åº·è¯„ä¼°
```python
# GUIå¥åº·åº¦
if errors == 0 and avg_time < 100:
    return "healthy"
elif errors < 2 and avg_time < 300:
    return "degraded"
else:
    return "unhealthy"

# é¡µé¢åŠ è½½å¥åº·åº¦
if avg_time < 1000 and errors == 0:
    return "healthy"
elif avg_time < 3000:
    return "degraded"
else:
    return "unhealthy"
```

### 4.3 å‰ç«¯æ•°æ®ä¸ŠæŠ¥æ¥å£
```python
# POST /api/v1/monitor/user-experience/interaction
# ç”¨äºå‰ç«¯å®æ—¶ä¸ŠæŠ¥ç”¨æˆ·äº¤äº’æ•°æ®

# POST /api/v1/monitor/user-experience/action
# ç”¨äºå‰ç«¯å®æ—¶ä¸ŠæŠ¥ç”¨æˆ·æ“ä½œæ•°æ®
```

---

## äº”ã€æ–‡ä»¶æ¸…å•

### 5.1 æ–°å¢æ–‡ä»¶

| æ–‡ä»¶ | è¡Œæ•° | è¯´æ˜ |
|------|------|------|
| `YL-monitor/app/services/user_experience_monitor.py` | ~650è¡Œ | æ ¸å¿ƒç›‘æ§å™¨å®ç° |
| `YL-monitor/app/api/v1/monitor/user_experience.py` | ~150è¡Œ | APIç«¯ç‚¹å®ç° |
| `éƒ¨ç½²/é˜¶æ®µ5-ç”¨æˆ·ä½“éªŒç›‘æ§-å®ŒæˆæŠ¥å‘Š.md` | ~280è¡Œ | å®ŒæˆæŠ¥å‘Š |

---

## å…­ã€äº”å±‚ç›‘æ§æ¶æ„æ±‡æ€»

### L1-L5 å®Œæˆå†…å®¹

| å±‚çº§ | ç›‘æ§å™¨ | çŠ¶æ€ | æŒ‡æ ‡æ•° |
|------|--------|------|--------|
| **L1 åŸºç¡€è®¾æ–½** | Process/Port/Filesystem | âœ… | 26 |
| **L2 ç³»ç»Ÿèµ„æº** | CPU/Memory/GPU | âœ… | 40 |
| **L3 åº”ç”¨æœåŠ¡** | API/Database/Cache | âœ… | 34 |
| **L4 ä¸šåŠ¡åŠŸèƒ½** | Video/FaceSwap/Audio | âœ… | 36 |
| **L5 ç”¨æˆ·ä½“éªŒ** | GUI/PageLoad/UserAction | âœ… | 25 |
| **åˆè®¡** | **15ä¸ªç›‘æ§å™¨** | **âœ…** | **161é¡¹æŒ‡æ ‡** |

### APIç«¯ç‚¹æ±‡æ€»

| å±‚çº§ | ç«¯ç‚¹æ•°é‡ | çŠ¶æ€ |
|------|----------|------|
| L1 åŸºç¡€è®¾æ–½ | 8ä¸ª | âœ… |
| L2 ç³»ç»Ÿèµ„æº | 8ä¸ª | âœ… |
| L3 åº”ç”¨æœåŠ¡ | 6ä¸ª | âœ… |
| L4 ä¸šåŠ¡åŠŸèƒ½ | 7ä¸ª | âœ… |
| L5 ç”¨æˆ·ä½“éªŒ | 8ä¸ª | âœ… |
| **åˆè®¡** | **37ä¸ª** | **âœ…** |

---

## ä¸ƒã€é¡¹ç›®æˆæœæ€»ç»“

### 7.1 ç›‘æ§é¢—ç²’åº¦å¯¹æ¯”

| ç»´åº¦ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | æå‡ |
|------|--------|--------|------|
| ç›‘æ§å±‚çº§ | 2å±‚ | 5å±‚ | 150% |
| ç›‘æ§å™¨æ•°é‡ | 3ä¸ª | 15ä¸ª | 400% |
| ç›‘æ§æŒ‡æ ‡ | 20é¡¹ | 161é¡¹ | 705% |
| APIç«¯ç‚¹ | 5ä¸ª | 37ä¸ª | 640% |
| é‡‡é›†é¢‘ç‡ | 60ç§’ | 5ç§’ | 12å€ |
| å‘Šè­¦ç²¾åº¦ | æœåŠ¡çº§ | ç»„ä»¶çº§ | ç²¾ç»† |

### 7.2 æ ¸å¿ƒèƒ½åŠ›

1. **å…¨æ ˆç›‘æ§**: ä»åŸºç¡€è®¾æ–½åˆ°ç”¨æˆ·ä½“éªŒçš„å®Œæ•´é“¾è·¯
2. **å®æ—¶å‘Šè­¦**: 5ç§’çº§æ•°æ®é‡‡é›†ï¼Œç§’çº§é—®é¢˜å‘ç°
3. **æ™ºèƒ½è¯„ä¼°**: å¤šç»´åº¦å¥åº·è¯„åˆ†ç®—æ³•
4. **å‰ç«¯é›†æˆ**: æ”¯æŒå‰ç«¯å®æ—¶æ•°æ®ä¸ŠæŠ¥
5. **ä¸šåŠ¡æ´å¯Ÿ**: è§†é¢‘/äººè„¸/éŸ³é¢‘ä¸“é¡¹ç›‘æ§

---

## å…«ã€å…³è”æ–‡æ¡£

- [ç›‘æ§é¢—ç²’åº¦ç»†åŒ–ä¼˜åŒ–æ–¹æ¡ˆ](./ç›‘æ§é¢—ç²’åº¦ç»†åŒ–ä¼˜åŒ–æ–¹æ¡ˆ.md)
- [é˜¶æ®µ1å®ŒæˆæŠ¥å‘Š](./é˜¶æ®µ1-åŸºç¡€è®¾æ–½ç›‘æ§-å®ŒæˆæŠ¥å‘Š.md)
- [é˜¶æ®µ2å®ŒæˆæŠ¥å‘Š](./é˜¶æ®µ2-ç³»ç»Ÿèµ„æºç›‘æ§-å®ŒæˆæŠ¥å‘Š.md)
- [é˜¶æ®µ3å®ŒæˆæŠ¥å‘Š](./é˜¶æ®µ3-åº”ç”¨æœåŠ¡ç›‘æ§-å®ŒæˆæŠ¥å‘Š.md)
- [é˜¶æ®µ4å®ŒæˆæŠ¥å‘Š](./é˜¶æ®µ4-ä¸šåŠ¡åŠŸèƒ½ç›‘æ§-å®ŒæˆæŠ¥å‘Š.md)
- [é˜¶æ®µ5å®ŒæˆæŠ¥å‘Š](./é˜¶æ®µ5-ç”¨æˆ·ä½“éªŒç›‘æ§-å®ŒæˆæŠ¥å‘Š.md)
- [éƒ¨ç½²ç´¢å¼•](./0.éƒ¨ç½²ç´¢å¼•.md)

---

**æŠ¥å‘Šäºº**: AI å…¨æ ˆæŠ€æœ¯å‘˜  
**å®¡æ ¸çŠ¶æ€**: å¾…å®¡æ ¸

---

## ğŸ‰ ç›‘æ§é¢—ç²’åº¦ç»†åŒ–ä¼˜åŒ–é¡¹ç›® - å…¨éƒ¨å®Œæˆï¼

**æ€»è€—æ—¶**: çº¦15å¤©ï¼ˆ5ä¸ªé˜¶æ®µï¼Œæ¯é˜¶æ®µ2-3å¤©ï¼‰  
**äº¤ä»˜ç‰©**: 15ä¸ªç›‘æ§å™¨ã€37ä¸ªAPIç«¯ç‚¹ã€161é¡¹æŒ‡æ ‡  
**çŠ¶æ€**: âœ… å…¨éƒ¨å®Œæˆï¼Œå¯æŠ•å…¥ç”Ÿäº§ä½¿ç”¨
