# YL-AR-DGN 安全配置
# 生产环境安全加固配置

# ============================================
# HTTPS/TLS 配置
# ============================================
SSL_ENABLED=true
SSL_CERT_PATH=/app/certs/server.crt
SSL_KEY_PATH=/app/certs/server.key
SSL_CA_PATH=/app/certs/ca.crt

# TLS版本（禁用旧版本）
TLS_MIN_VERSION=1.2
TLS_MAX_VERSION=1.3

# 加密套件
SSL_CIPHERS=ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384

# HSTS配置
HSTS_ENABLED=true
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true

# ============================================
# API 安全
# ============================================
# API密钥（生产环境必须修改！）
API_KEY_HEADER=X-API-Key
API_KEY_QUERY_PARAM=api_key

# 速率限制
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW=60

# 请求大小限制
MAX_REQUEST_SIZE=10MB
MAX_JSON_SIZE=1MB

# 请求超时
REQUEST_TIMEOUT=30
KEEP_ALIVE_TIMEOUT=5

# ============================================
# CORS 配置
# ============================================
CORS_ENABLED=true
# 允许的域名（生产环境必须配置具体域名）
CORS_ORIGINS=https://your-domain.com,https://admin.your-domain.com
CORS_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_HEADERS=Content-Type,Authorization,X-API-Key
CORS_CREDENTIALS=true
CORS_MAX_AGE=3600

# ============================================
# 认证与授权
# ============================================
# JWT配置
JWT_SECRET_KEY=your-jwt-secret-key-change-in-production
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# 会话配置
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=Strict
SESSION_TIMEOUT=3600

# 密码策略
PASSWORD_MIN_LENGTH=8
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SPECIAL=true

# ============================================
# 输入验证
# ============================================
# SQL注入防护
SQL_INJECTION_CHECK=true

# XSS防护
XSS_PROTECTION=true
CONTENT_SECURITY_POLICY=default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline';

# CSRF防护
CSRF_PROTECTION=true
CSRF_TOKEN_HEADER=X-CSRF-Token

# 文件上传限制
ALLOWED_UPLOAD_EXTENSIONS=.jpg,.jpeg,.png,.gif,.mp4,.wav
MAX_UPLOAD_SIZE=50MB
UPLOAD_SCAN_VIRUS=true

# ============================================
# 日志与审计
# ============================================
# 安全日志
SECURITY_LOG_ENABLED=true
SECURITY_LOG_LEVEL=WARNING
SECURITY_LOG_PATH=/app/logs/security.log

# 审计日志
AUDIT_LOG_ENABLED=true
AUDIT_LOG_PATH=/app/logs/audit.log
AUDIT_LOG_RETENTION_DAYS=90

# 登录审计
LOG_LOGIN_ATTEMPTS=true
LOG_FAILED_LOGINS=true
MAX_FAILED_LOGIN_ATTEMPTS=5
FAILED_LOGIN_LOCKOUT_MINUTES=30

# ============================================
# 网络安全
# ============================================
# IP白名单（可选）
IP_WHITELIST_ENABLED=false
IP_WHITELIST=127.0.0.1,::1

# IP黑名单
IP_BLACKLIST_ENABLED=false
IP_BLACKLIST=

# DDoS防护
DDOS_PROTECTION_ENABLED=true
DDOS_REQUEST_THRESHOLD=1000
DDOS_TIME_WINDOW=60

# ============================================
# 数据安全
# ============================================
# 数据加密
DATA_ENCRYPTION_ENABLED=true
DATA_ENCRYPTION_KEY_PATH=/app/keys/data.key

# 数据库加密
DATABASE_ENCRYPTION_ENABLED=false

# 备份加密
BACKUP_ENCRYPTION_ENABLED=true
BACKUP_ENCRYPTION_KEY_PATH=/app/keys/backup.key

# ============================================
# 安全扫描
# ============================================
# 依赖漏洞扫描
DEPENDENCY_SCAN_ENABLED=true
DEPENDENCY_SCAN_SCHEDULE=0 2 * * *  # 每天凌晨2点

# 代码安全扫描
CODE_SCAN_ENABLED=true
CODE_SCAN_SCHEDULE=0 3 * * 0  # 每周日凌晨3点

# 容器安全扫描
CONTAINER_SCAN_ENABLED=true
CONTAINER_SCAN_SCHEDULE=0 4 * * 0  # 每周日凌晨4点

# ============================================
# 应急响应
# ============================================
# 安全事件响应
INCIDENT_RESPONSE_ENABLED=true
INCIDENT_RESPONSE_TEAM=security@your-domain.com

# 自动阻断
AUTO_BLOCK_ENABLED=true
AUTO_BLOCK_THRESHOLD=10
AUTO_BLOCK_DURATION=3600

# 告警通知
SECURITY_ALERT_ENABLED=true
SECURITY_ALERT_EMAIL=security@your-domain.com
SECURITY_ALERT_WEBHOOK=

# ============================================
# 合规配置
# ============================================
# GDPR合规
GDPR_COMPLIANCE_ENABLED=false
DATA_RETENTION_DAYS=365

# 数据隐私
PII_DETECTION_ENABLED=true
PII_MASKING_ENABLED=true

# 日志脱敏
LOG_MASKING_ENABLED=true
LOG_MASK_FIELDS=password,token,api_key,secret
